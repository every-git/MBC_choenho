<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íšŒì› ê´€ë¦¬</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Toast Message -->
    <div th:if="${message}" class="toast" th:texì •t="${message}"></div>

    <div class="container">
        <div class="card">
            <!-- Header -->
            <div class="page-header">
                <div>
                    <h1 class="page-title">íšŒì› ëª©ë¡</h1>
                    <p class="page-subtitle">ì „ì²´ íšŒì› ì •ë³´ë¥¼ ì¡°íšŒí•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
                </div>
                <a th:href="@{/member/register}" class="btn btn-primary">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M12 5v14M5 12h14"/>
                    </svg>
                    ì‹ ê·œ ë“±ë¡
                </a>
            </div>

            <!-- Table -->
            <div class="table-container">
                <!-- Empty State -->
                <div th:if="${#lists.isEmpty(list)}" class="empty-state">
                    <div class="empty-state-icon">ğŸ“‹</div>
                    <p class="empty-state-text">ë“±ë¡ëœ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    <a th:href="@{/member/register}" class="btn btn-primary">ì²« íšŒì› ë“±ë¡í•˜ê¸°</a>
                </div>

                <!-- Table -->
                <table th:unless="${#lists.isEmpty(list)}">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>ì´ë¦„</th>
                            <th>ë‚˜ì´</th>
                            <th>ì£¼ì†Œ</th>
                            <th>ì—°ë½ì²˜</th>
                            <th>ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="member : ${list}">
                            <td th:text="${member.memberId}">1</td>
                            <td>
                                <a th:href="@{/member/view/{id}(id=${member.memberId})}" 
                                   th:text="${member.name}" 
                                   class="member-name">í™ê¸¸ë™</a>
                            </td>
                            <td th:text="${member.age}">25</td>
                            <td th:text="${member.address}">ì„œìš¸ì‹œ ê°•ë‚¨êµ¬</td>
                            <td th:text="${member.phone}">010-1234-5678</td>
                            <td>
                                <div class="table-actions">
                                    <a th:href="@{/member/modify/{id}(id=${member.memberId})}" 
                                       class="btn btn-secondary btn-sm">ìˆ˜ì •</a>
                                    <button type="button" 
                                            class="btn btn-danger btn-sm" 
                                            th:data-id="${member.memberId}"
                                            th:data-name="${member.name}"
                                            onclick="showDeleteModal(this)">ì‚­ì œ</button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-icon">âš ï¸</div>
            <h3 class="modal-title">íšŒì› ì‚­ì œ</h3>
            <p class="modal-message">
                <span id="deleteName"></span> íšŒì›ì„ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?<br>
                <small style="color: var(--error);">ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</small>
            </p>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeDeleteModal()">ì·¨ì†Œ</button>
                <form id="deleteForm" th:action="@{/member/delete/0}" method="post" style="display:inline;">
                    <button type="submit" class="btn btn-danger">ì‚­ì œ</button>
                </form>
            </div>
        </div>
    </div>

    <script th:inline="javascript">
        // Toast auto-hide
        document.addEventListener('DOMContentLoaded', function() {
            const toast = document.querySelector('.toast');
            if (toast) {
                setTimeout(() => toast.remove(), 3000);
            }
        });

        // Delete Modal
        function showDeleteModal(btn) {
            const id = btn.dataset.id;
            const name = btn.dataset.name;
            document.getElementById('deleteName').textContent = name;
            document.getElementById('deleteForm').action = '/member/delete/' + id;
            document.getElementById('deleteModal').classList.add('active');
        }

        function closeDeleteModal() {
            document.getElementById('deleteModal').classList.remove('active');
        }

        // Close modal on overlay click
        document.getElementById('deleteModal').addEventListener('click', function(e) {
            if (e.target === this) closeDeleteModal();
        });

        // Close modal on ESC key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeDeleteModal();
        });
    </script>
</body>
</html>
